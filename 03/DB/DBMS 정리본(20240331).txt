-- 선택형 방식
SELECT * FROM EMP;
-- EMP 테이블 전체출력
SELECT * FROM DEPT;
-- DEPT 테이블 전체출력

-- Q.1 부서번호가 10번인 사람출력
-- 해석 EMP의 전체부분을 확인하고 부서번호가 10번 즉 조건(WHERE)이 (DEPTNO=10)이기 때문에
-- 총정리하면 SELECT * FROM EMP WHERE DEPTNO = 10;이 결과값이 된다.

SELECT * FROM EMP
WHERE DEPTNO = 10;

-- Q.2 부서번호가 10번인 사람 중 사원번호(EMPNO),이름(ENAME),월급(SAL)만 출력
-- 총 정리하면 SELECT EMPNO(사원번호), ENAME(이름), SAL(월급)
-- FROM EMP WHERE DEPTNO=10;

SELECT EMPNO, ENAME, SAL FROM EMP
WHERE DEPTNO = 10;

-- Q.3 입사일이 1980/12/17인 사원의 이름, 부서번호, 월급출력
-- 우선 참조할 테이블이 EMP이고 입사일이 HIREDATE이며 
-- 사원의이름(ENAME), 부서번호(DEPTNO), 월급(SAL)
-- 조건이 1980/12/17 즉 HIREDATE 이기 때문에 WHERE HIREDATE = '1980/12/17'(DATE는문자)

SELECT ENAME, DEPTNO, SAL FROM EMP 
WHERE HIREDATE='1980/12/17';

-- Q.4 직업이 MANAGER인 사람의 모든정보 출력 / MANAGER가 아닌 사람의 모든 정보출력
-- 참조할 테이블이 EMP 모든정보기 떄문에 *사용 조건이 MANAGER를 구하기때문에 WHERE문사용
-- JOB테이블에 직업이 있기 때문에 WHERE JOB = 'MANAGER' 아닌것은 <>기호 또는 !기호 사용

SELECT * FROM EMP WHERE JOB = 'MANAGER';
SELECT * FROM EMP WHERE JOB <> 'MANAGER';
SELECT * FROM EMP WHERE JOB != 'MANAGER';

-- Q.5 급여가 1000 이상인 사람의 이름, 급여, 부서번호를 급여가 높은 순으로 출력
-- 참조할 테이블은 EMP 이름(ENAME),급여(SAL),부서번호(DEPTNO)이고 조건은
-- 급여(SAL)가 1000이상 급여가 높은순(ORDER BY SAL DESC)으로 정렬이기 때문에
-- 낮은순은 ORDER BY SQL ASC(생략가능) 

SELECT ENAME, SAL, DEPTNO FROM EMP WHERE SAL >= 1000 ORDER BY SAL DESC;
SELECT ENAME, SAL, DEPTNO FROM EMP WHERE SAL >= 1000 ORDER BY SAL ASC;
SELECT ENAME, SAL, DEPTNO FROM EMP WHERE SAL >= 1000 ORDER BY SAL;

-- Q.6 부서번호 10,20인 사원의 이름,급여,부서번호
-- 참조하는 테이블이 EMP 테이블이고 조회할 내용이 이름(ENAME), 급여(SAL), 부서번호(DEPTNO)
-- 조건(WHERE)이 부서번호(DEPTNO)10,20이기 때문에 합집합개념으로 UNION이라는 함수를
-- 이용하는게 편함 해당내용을 정리하면

SELECT ENAME, SAL, DEPTNO FROM EMP WHERE DEPTNO = 10
UNION
SELECT ENAME, SAL, DEPTNO FROM EMP WHERE DEPTNO = 20;

-- Q.7 부서번호 10인 사원을 제외하고 나머지의 사원번호,이름,급여,부서번호
-- 참조 테이블이 EMP이고 조회할 내용이 사원번호(EMPNO), 이름(ENAME), 급여(SAL), 
-- 부서번호(DEPTNO)
-- 부서번호 10번을 제외했기 때문에 MINUS 함수를 사용한다.
-- 내용을 총정리하면

SELECT EMPNO, ENAME, SAL, DEPTNO FROM EMP
MINUS
SELECT EMPNO, ENAME, SAL, DEPTNO FROM EMP
WHERE DEPTNO=10;

-- Q.8 전체에서 부서번호가 20인 사람만 출력하세요(함수 INTERSECT 사용)
-- 참조 테이블이 EMP이고 조회할 내용이 전체(*) 이중에 부서번호 20번만을 포함시키기 때문에
-- 교집합 함수인 INTERSECT를 활용한다.

SELECT * FROM EMP
INTERSECT
SELECT * FROM EMP WHERE DEPTNO='20';

-- Q.9 사원이름이 S로 끝나는 사원의 모든 데이터 출력
-- 테이블 EMP 전체참조(*) / 조건 WHERE S로끝나는 거기 때문에 '%S'를 사용함
-- SELECT * FROM EMP WHERE ENAME LIKE '%S';

SELECT * FROM EMP WHERE ENAME LIKE '%S';

-- Q.10 2가지 이상의 WHERE / 30번 부서에서 근무하는 사원 중 JOB이 SALESMAN인 사원의
-- 사원번호, 이름, 직책, 급여, 부서번호 출력
-- TABLE EMP 사원번호(EMPNO), 이름(ENAME), 직책(JOB), 부서번호(DEPTNO)
-- 방식은 2가지 집합함수사용/AND 사용
-- SELECT ENAME, JOB, DEPTNO FROM EMP WHERE DEPTNO = 20 
-- UNION
-- SELECT ENAME, JOB, DEPTNO FROM EMP WHERE JOB = 'SALESMAN'
-- WHERE DEPTNO = 20 AND JOB = 'SALESMAN' 
-- (DEPTNO = 20, JOB = 'SALESMAN' 이니깐 AND를 사용 또는의 경우 OR사용)

SELECT ENAME, JOB, DEPTNO FROM EMP WHERE DEPTNO = 30 
INTERSECT
SELECT ENAME, JOB, DEPTNO FROM EMP WHERE JOB = 'SALESMAN';

SELECT ENAME, JOB, DEPTNO FROM EMP
WHERE DEPTNO = 30 AND JOB = 'SALESMAN'; 

-- Q.11 사원이름에 E가 포함/ 30번부서의 사원중 급여가 1000~2000 사이가 아닌 전체정보를
-- 급여 내림차순으로 정렬
-- 테이블 전체정보기 때문에 SELECT * FROM EMP / 조건 사원이름 E, 30번부서 사원,
-- 급여 1000~2000사이 아님, 내림차순(WHERE LIKE '%E%', DEPTNO = 30, 
-- BETWEEN 1000 AND 2000, ORDER BY (주체) DESC)

SELECT * FROM EMP
WHERE ENAME LIKE '%E%' AND DEPTNO =30 AND SAL NOT BETWEEN 1000 AND 2000
ORDER BY SAL DESC;

-- Q.12 주가수당이 존재하지 않는 사람의 정보 출력 / 존재하는 사람 정보출력
-- 테이블은 EMP를 참조 / 전체정보(*), 조건 존재하지 않는 주가수당(COMM) IS NULL 사용
-- 존재하는을 찾을때는 NOT NULL

SELECT * FROM EMP
WHERE COMM IS NULL; 

SELECT * FROM EMP
WHERE COMM IS NOT NULL; 

-- Q.13 전체정리 / 주가수당이 존재하지 않고 상급자가 있고 직급이 MANAGER, CLERK인 사원중에서
-- 사원이름의 두번째 글자가 L이아닌 사원정보 출력
-- 테이블은 EMP 참조 / 전체정보(*) /
-- 조건 주가수당(COMM) 존재X, 상급자(MGR) 존재(IS NOT NULL), 직급(JOB) 2가지 이상이기 때문에
-- 편의상 IN을 사용(MANAGER,CLERK)
-- 사원이름의 두번째
-- 글자가 L이아닌 사원정보 출력(_순위번째를 의미) _?(2번쨰 ?탐색)

SELECT * FROM EMP
WHERE COMM IS NULL 
AND MGR IS NOT NULL 
AND JOB IN ('MANAGER','CLERK')
AND ENAME LIKE '_L%';

-- Q.14 내장함수 정리 / 이름 대문자,소문자 분류(UPPER,LOWER), INITCAP(첫글자만 대문자)

SELECT ENAME, UPPER(ENAME) AS 대문자, LOWER(ENAME) 소문자, INITCAP(ENAME)
FROM EMP;

-- Q.15 내장함수 정리 / 이름길이(LENGTH)
SELECT ENAME, LENGTH(ENAME) AS 길이
FROM EMP;

-- Q.16 내장함수 / 문자출력(SUBSTR)
-- 문자의 제일앞에서 부터 3개추출 / 문자의 제일 뒤에껏만 추출
SELECT ENAME, SUBSTR(ENAME,1,3) AS 문자출력
FROM EMP;

SELECT ENAME, SUBSTR(ENAME,-1,1) AS 문자출력
FROM EMP;

-- Q 17. 내장함수 / 위치값 출력(INSTR) 입력하지 않을 땐 기본은 1이궁
-- -1은 뒤에서 채우는 것 뒤에 숫자는 뒤에서 몇번째 앞에서 몇번째를 의미 
SELECT INSTR('STARS','S'),INSTR('STARS','S',-1),INSTR('STARS','S',-1,2)
FROM DUAL;

 